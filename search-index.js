crystal_doc_search_index_callback({"repository_name":"modbus","body":"# modbus.cr\n\nModbus client library for Crystal\n\n## Installation\n\n1. Add the dependency to your `shard.yml`:\n\n   ```yaml\n   dependencies:\n     modbus:\n       github: scttnlsn/modbus.cr\n   ```\n\n2. Run `shards install`\n\n## Usage\n\n```crystal\nrequire \"modbus\"\n```\n\n## Documentation\n\n[API (master)](https://scttnlsn.github.io/modbus.cr/)\n\n## Example\n\n```bash\nstty -F /dev/ttyUSB0 cs8 19200 ignbrk -brkint -icrnl -imaxbel -opost -onlcr -isig -icanon -iexten -echo -echoe -echok -echoctl -echoke noflsh -ixon -crtscts -hupcl\n```\n\n```crystal\nrequire \"modbus\"\n\nserial_port = File.open(\"/dev/ttyUSB0\", \"r+\")\nrtu_client = Modbus::RTUClient.open(serial_port)\n\n# read 4 coils starting at address 1\ncoils : BitArray = rtu_client.read_coils(1, 4)\nputs coils\n\nrequire \"socket\"\n\nsocket = TCPSocket.new(\"example.modbus.host\", 502)\ntcp_client = Modbus::TCPClient.new(socket)\n\n# read 1 register starting at address 123\nregisters = tcp_client.read_holding_registers(123, 1)\nputs registers[0]\n```\n\n## Testing\n\nTo run the tests:\n\n```\ncrystal spec\n```\n\n## Resources\n\nModbus protocol info:\n\n* https://www.fernhillsoftware.com/help/drivers/modbus/modbus-protocol.html\n* https://minimalmodbus.readthedocs.io/en/stable/modbusdetails.html\n","program":{"html_id":"modbus/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"modbus","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"modbus/Modbus","path":"Modbus.html","kind":"module","full_name":"Modbus","name":"Modbus","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/modbus.cr","line_number":3,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus.cr#L3"},{"filename":"src/modbus/buffer.cr","line_number":1,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L1"},{"filename":"src/modbus/client.cr","line_number":3,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L3"},{"filename":"src/modbus/errors.cr","line_number":1,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/errors.cr#L1"},{"filename":"src/modbus/pdu.cr","line_number":1,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/pdu.cr#L1"},{"filename":"src/modbus/rtu.cr","line_number":1,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu.cr#L1"},{"filename":"src/modbus/rtu_client.cr","line_number":1,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu_client.cr#L1"},{"filename":"src/modbus/tcp.cr","line_number":1,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp.cr#L1"},{"filename":"src/modbus/tcp_client.cr","line_number":1,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp_client.cr#L1"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"EXCEPTIONS","name":"EXCEPTIONS","value":"{1 => \"Illegal Function\", 2 => \"Illegal Data Address\", 3 => \"Illegal Data Value\", 4 => \"Slave Device Failure\", 5 => \"Acknowledge\", 6 => \"Slave Device Busy\", 7 => \"Negative Acknowledge\", 8 => \"Memory Parity Error\", 10 => \"Gateway Path Unavailable\", 11 => \"Gateway Target Device Failed to Respond\"}","doc":null,"summary":null},{"id":"VERSION","name":"VERSION","value":"\"0.1.0\"","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"modbus/Modbus/Buffer","path":"Modbus/Buffer.html","kind":"class","full_name":"Modbus::Buffer","name":"Buffer","abstract":false,"superclass":{"html_id":"modbus/IO","kind":"class","full_name":"IO","name":"IO"},"ancestors":[{"html_id":"modbus/IO","kind":"class","full_name":"IO","name":"IO"},{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/buffer.cr","line_number":2,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L2"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(buffer:IO::Memory=IO::Memory.new)-class-method","html_id":"new(buffer:IO::Memory=IO::Memory.new)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"buffer","doc":null,"default_value":"IO::Memory.new","external_name":"buffer","restriction":"IO::Memory"}],"args_string":"(buffer : IO::Memory = <span class=\"t\">IO</span><span class=\"t\">::</span><span class=\"t\">Memory</span>.<span class=\"k\">new</span>)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L3","def":{"name":"new","args":[{"name":"buffer","doc":null,"default_value":"IO::Memory.new","external_name":"buffer","restriction":"IO::Memory"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(buffer)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"bits-instance-method","html_id":"bits-instance-method","name":"bits","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L23","def":{"name":"bits","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"bits = BitArray.new(@buffer.size * 8)\ni = 0\n@buffer.to_slice.each do |byte|\n  (0...8).each do |shift|\n    bit = ((byte >> shift) & 1)\n    bits[i] = (    bit == 1)\n    i = i + 1\n  end\nend\nbits\n"}},{"id":"crc16-instance-method","html_id":"crc16-instance-method","name":"crc16","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L44","def":{"name":"crc16","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"crc = 65535_u16\n@buffer.to_slice.each do |byte|\n  crc = crc ^ byte\n  (0...8).each do |shift|\n    if (crc & 1) != 0\n      crc = crc >> 1\n      crc = crc ^ 40961\n    else\n      crc = crc >> 1\n    end\n  end\nend\ncrc\n"}},{"id":"read(bytes)-instance-method","html_id":"read(bytes)-instance-method","name":"read","doc":null,"summary":null,"abstract":false,"args":[{"name":"bytes","doc":null,"default_value":"","external_name":"bytes","restriction":""}],"args_string":"(bytes)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L7","def":{"name":"read","args":[{"name":"bytes","doc":null,"default_value":"","external_name":"bytes","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@buffer.read(bytes)"}},{"id":"to_slice-instance-method","html_id":"to_slice-instance-method","name":"to_slice","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L19","def":{"name":"to_slice","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@buffer.to_slice"}},{"id":"words-instance-method","html_id":"words-instance-method","name":"words","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L38","def":{"name":"words","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"(@buffer.to_slice.in_groups_of(2, 0)).map do |__arg0|\n  msb = __arg0[0]\n  lsb = __arg0[1]\n  (msb.to_u16 << 8) | lsb.to_u16\nend"}},{"id":"write(bytes):Nil-instance-method","html_id":"write(bytes):Nil-instance-method","name":"write","doc":null,"summary":null,"abstract":false,"args":[{"name":"bytes","doc":null,"default_value":"","external_name":"bytes","restriction":""}],"args_string":"(bytes) : Nil","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L11","def":{"name":"write","args":[{"name":"bytes","doc":null,"default_value":"","external_name":"bytes","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Nil","visibility":"Public","body":"@buffer.write(bytes)"}},{"id":"write_crc-instance-method","html_id":"write_crc-instance-method","name":"write_crc","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L63","def":{"name":"write_crc","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"result = IO::Memory.new\nresult.write_bytes(crc16, IO::ByteFormat::LittleEndian)\nwrite(result.to_slice)\n"}},{"id":"write_word(value:UInt16)-instance-method","html_id":"write_word(value:UInt16)-instance-method","name":"write_word","doc":null,"summary":null,"abstract":false,"args":[{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"UInt16"}],"args_string":"(value : UInt16)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/buffer.cr#L15","def":{"name":"write_word","args":[{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"UInt16"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@buffer.write_bytes(value, IO::ByteFormat::BigEndian)"}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/Client","path":"Modbus/Client.html","kind":"class","full_name":"Modbus::Client","name":"Client","abstract":false,"superclass":{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/client.cr","line_number":4,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L4"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[{"html_id":"modbus/Modbus/RTUClient","kind":"class","full_name":"Modbus::RTUClient","name":"RTUClient"},{"html_id":"modbus/Modbus/TCPClient","kind":"class","full_name":"Modbus::TCPClient","name":"TCPClient"}],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(io:IO)-class-method","html_id":"new(io:IO)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"}],"args_string":"(io : IO)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L7","def":{"name":"new","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(io)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"io:IO-instance-method","html_id":"io:IO-instance-method","name":"io","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : IO","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L5","def":{"name":"io","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@io"}},{"id":"read_coils(addr:UInt16,num_coils:UInt16):BitArray-instance-method","html_id":"read_coils(addr:UInt16,num_coils:UInt16):BitArray-instance-method","name":"read_coils","doc":null,"summary":null,"abstract":false,"args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_coils","doc":null,"default_value":"","external_name":"num_coils","restriction":"UInt16"}],"args_string":"(addr : UInt16, num_coils : UInt16) : BitArray","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L10","def":{"name":"read_coils","args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_coils","doc":null,"default_value":"","external_name":"num_coils","restriction":"UInt16"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"BitArray","visibility":"Public","body":"read_bits(1, addr, num_coils)"}},{"id":"read_discrete_inputs(addr:UInt16,num_inputs:UInt16):BitArray-instance-method","html_id":"read_discrete_inputs(addr:UInt16,num_inputs:UInt16):BitArray-instance-method","name":"read_discrete_inputs","doc":null,"summary":null,"abstract":false,"args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_inputs","doc":null,"default_value":"","external_name":"num_inputs","restriction":"UInt16"}],"args_string":"(addr : UInt16, num_inputs : UInt16) : BitArray","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L14","def":{"name":"read_discrete_inputs","args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_inputs","doc":null,"default_value":"","external_name":"num_inputs","restriction":"UInt16"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"BitArray","visibility":"Public","body":"read_bits(2, addr, num_inputs)"}},{"id":"read_holding_registers(addr:UInt16,num_registers:UInt16):Array(UInt16)-instance-method","html_id":"read_holding_registers(addr:UInt16,num_registers:UInt16):Array(UInt16)-instance-method","name":"read_holding_registers","doc":null,"summary":null,"abstract":false,"args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_registers","doc":null,"default_value":"","external_name":"num_registers","restriction":"UInt16"}],"args_string":"(addr : UInt16, num_registers : UInt16) : Array(UInt16)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L18","def":{"name":"read_holding_registers","args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_registers","doc":null,"default_value":"","external_name":"num_registers","restriction":"UInt16"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(UInt16)","visibility":"Public","body":"read_bytes(3, addr, num_registers)"}},{"id":"read_input_registers(addr:UInt16,num_registers:UInt16):Array(UInt16)-instance-method","html_id":"read_input_registers(addr:UInt16,num_registers:UInt16):Array(UInt16)-instance-method","name":"read_input_registers","doc":null,"summary":null,"abstract":false,"args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_registers","doc":null,"default_value":"","external_name":"num_registers","restriction":"UInt16"}],"args_string":"(addr : UInt16, num_registers : UInt16) : Array(UInt16)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L22","def":{"name":"read_input_registers","args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"num_registers","doc":null,"default_value":"","external_name":"num_registers","restriction":"UInt16"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(UInt16)","visibility":"Public","body":"read_bytes(4, addr, num_registers)"}},{"id":"write_multiple_registers(addr:UInt16,values:Array(UInt16)):Array(UInt16)-instance-method","html_id":"write_multiple_registers(addr:UInt16,values:Array(UInt16)):Array(UInt16)-instance-method","name":"write_multiple_registers","doc":null,"summary":null,"abstract":false,"args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"values","doc":null,"default_value":"","external_name":"values","restriction":"Array(UInt16)"}],"args_string":"(addr : UInt16, values : Array(UInt16)) : Array(UInt16)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L65","def":{"name":"write_multiple_registers","args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"values","doc":null,"default_value":"","external_name":"values","restriction":"Array(UInt16)"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(UInt16)","visibility":"Public","body":"function_code = 16_u8\npdu = IO::Memory.new\npdu.write_byte(function_code)\npdu.write_bytes(addr - 1, IO::ByteFormat::BigEndian)\npdu.write_bytes(values.size.to_u16, IO::ByteFormat::BigEndian)\npdu.write_byte(values.size.to_u8 * 2)\nvalues.each do |value|\n  pdu.write_bytes(value.to_u16, IO::ByteFormat::BigEndian)\nend\nsend_message(pdu.to_slice)\nbuffer = recv_message(function_code)\naddr, count = buffer.words\n[addr + 1, count]\n"}},{"id":"write_single_coil(addr:UInt16,value:Bool):Bool-instance-method","html_id":"write_single_coil(addr:UInt16,value:Bool):Bool-instance-method","name":"write_single_coil","doc":null,"summary":null,"abstract":false,"args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"Bool"}],"args_string":"(addr : UInt16, value : Bool) : Bool","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L26","def":{"name":"write_single_coil","args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"Bool"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"function_code = 5_u8\npdu = IO::Memory.new\npdu.write_byte(function_code)\npdu.write_bytes(addr - 1, IO::ByteFormat::BigEndian)\nif value\n  pdu.write_byte(255)\n  pdu.write_byte(0)\nelse\n  pdu.write_byte(0)\n  pdu.write_byte(0)\nend\nsend_message(pdu.to_slice)\nbuffer = recv_message(function_code)\naddr, val = buffer.words\nval == 65280\n"}},{"id":"write_single_register(addr:UInt16,value:UInt16):UInt16-instance-method","html_id":"write_single_register(addr:UInt16,value:UInt16):UInt16-instance-method","name":"write_single_register","doc":null,"summary":null,"abstract":false,"args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"UInt16"}],"args_string":"(addr : UInt16, value : UInt16) : UInt16","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/client.cr#L50","def":{"name":"write_single_register","args":[{"name":"addr","doc":null,"default_value":"","external_name":"addr","restriction":"UInt16"},{"name":"value","doc":null,"default_value":"","external_name":"value","restriction":"UInt16"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"UInt16","visibility":"Public","body":"function_code = 6_u8\npdu = IO::Memory.new\npdu.write_byte(function_code)\npdu.write_bytes(addr - 1, IO::ByteFormat::BigEndian)\npdu.write_bytes(value, IO::ByteFormat::BigEndian)\nsend_message(pdu.to_slice)\nbuffer = recv_message(function_code)\naddr, val = buffer.words\nval\n"}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/ModbusException","path":"Modbus/ModbusException.html","kind":"class","full_name":"Modbus::ModbusException","name":"ModbusException","abstract":false,"superclass":{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/errors.cr","line_number":15,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/errors.cr#L15"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(exception_code)-class-method","html_id":"new(exception_code)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"exception_code","doc":null,"default_value":"","external_name":"exception_code","restriction":""}],"args_string":"(exception_code)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/errors.cr#L18","def":{"name":"new","args":[{"name":"exception_code","doc":null,"default_value":"","external_name":"exception_code","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(exception_code)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"pdu-instance-method","html_id":"pdu-instance-method","name":"pdu","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/errors.cr#L16","def":{"name":"pdu","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@pdu"}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/PDU","path":"Modbus/PDU.html","kind":"class","full_name":"Modbus::PDU","name":"PDU","abstract":false,"superclass":{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/pdu.cr","line_number":5,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/pdu.cr#L5"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(function_code:UInt8)-class-method","html_id":"new(function_code:UInt8)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"function_code","doc":null,"default_value":"","external_name":"function_code","restriction":"UInt8"}],"args_string":"(function_code : UInt8)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/pdu.cr#L8","def":{"name":"new","args":[{"name":"function_code","doc":null,"default_value":"","external_name":"function_code","restriction":"UInt8"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(function_code)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"bytes-instance-method","html_id":"bytes-instance-method","name":"bytes","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/pdu.cr#L35","def":{"name":"bytes","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"bytes = IO::Memory.new\nbytes.write_byte(@function_code)\nif @function_code < 5\n  bytes.write_byte(data.size.to_u8)\nend\nbytes.write(data)\nbytes.to_slice\n"}},{"id":"data:Slice(UInt8)-instance-method","html_id":"data:Slice(UInt8)-instance-method","name":"data","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Slice(UInt8)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/pdu.cr#L6","def":{"name":"data","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@data"}},{"id":"recv(io:IO)-instance-method","html_id":"recv(io:IO)-instance-method","name":"recv","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"}],"args_string":"(io : IO)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/pdu.cr#L12","def":{"name":"recv","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"function_code = io.read_byte || (raise(IO::EOFError.new))\nif function_code != @function_code\n  if function_code == (@function_code + 128)\n    exception_code = io.read_byte || (raise(IO::EOFError.new))\n    raise(ModbusException.new(exception_code))\n  else\n    raise(PDUException.new(\"function code mismatch\"))\n  end\nend\nif function_code < 5\n  byte_count = io.read_byte || (raise(IO::EOFError.new))\n  @data = Bytes.new(byte_count)\n  io.read_fully(@data)\nelse\n  @data = Bytes.new(4)\n  io.read_fully(@data)\nend\n"}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/PDUException","path":"Modbus/PDUException.html","kind":"class","full_name":"Modbus::PDUException","name":"PDUException","abstract":false,"superclass":{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/pdu.cr","line_number":2,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/pdu.cr#L2"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"modbus/Modbus/RTU","path":"Modbus/RTU.html","kind":"module","full_name":"Modbus::RTU","name":"RTU","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/modbus/rtu.cr","line_number":5,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu.cr#L5"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[{"html_id":"modbus/Modbus/RTUClient","kind":"class","full_name":"Modbus::RTUClient","name":"RTUClient"}],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"unit_address-instance-method","html_id":"unit_address-instance-method","name":"unit_address","doc":null,"summary":null,"abstract":true,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu.cr#L6","def":{"name":"unit_address","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/RTUClient","path":"Modbus/RTUClient.html","kind":"class","full_name":"Modbus::RTUClient","name":"RTUClient","abstract":false,"superclass":{"html_id":"modbus/Modbus/Client","kind":"class","full_name":"Modbus::Client","name":"Client"},"ancestors":[{"html_id":"modbus/Modbus/RTU","kind":"module","full_name":"Modbus::RTU","name":"RTU"},{"html_id":"modbus/Modbus/Client","kind":"class","full_name":"Modbus::Client","name":"Client"},{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/rtu_client.cr","line_number":2,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu_client.cr#L2"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"modbus/Modbus/RTU","kind":"module","full_name":"Modbus::RTU","name":"RTU"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[{"id":"open(fd:IO::FileDescriptor,unit_address:UInt8=1)-class-method","html_id":"open(fd:IO::FileDescriptor,unit_address:UInt8=1)-class-method","name":"open","doc":null,"summary":null,"abstract":false,"args":[{"name":"fd","doc":null,"default_value":"","external_name":"fd","restriction":"IO::FileDescriptor"},{"name":"unit_address","doc":null,"default_value":"1","external_name":"unit_address","restriction":"UInt8"}],"args_string":"(fd : IO::FileDescriptor, unit_address : UInt8 = <span class=\"n\">1</span>)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu_client.cr#L7","def":{"name":"open","args":[{"name":"fd","doc":null,"default_value":"","external_name":"fd","restriction":"IO::FileDescriptor"},{"name":"unit_address","doc":null,"default_value":"1","external_name":"unit_address","restriction":"UInt8"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"fd.sync = true\nfd.read_buffering = false\nfd.blocking = true\nfd.raw!\nnew(fd, unit_address)\n"}}],"constructors":[{"id":"new(io,unit_address:UInt8=1)-class-method","html_id":"new(io,unit_address:UInt8=1)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"unit_address","doc":null,"default_value":"1","external_name":"unit_address","restriction":"UInt8"}],"args_string":"(io, unit_address : UInt8 = <span class=\"n\">1</span>)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu_client.cr#L16","def":{"name":"new","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"unit_address","doc":null,"default_value":"1","external_name":"unit_address","restriction":"UInt8"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(io, unit_address)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"unit_address:UInt8-instance-method","html_id":"unit_address:UInt8-instance-method","name":"unit_address","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : UInt8","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu_client.cr#L5","def":{"name":"unit_address","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@unit_address"}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/RTUException","path":"Modbus/RTUException.html","kind":"class","full_name":"Modbus::RTUException","name":"RTUException","abstract":false,"superclass":{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/rtu.cr","line_number":2,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/rtu.cr#L2"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]},{"html_id":"modbus/Modbus/TCP","path":"Modbus/TCP.html","kind":"module","full_name":"Modbus::TCP","name":"TCP","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/modbus/tcp.cr","line_number":5,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp.cr#L5"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[{"html_id":"modbus/Modbus/TCPClient","kind":"class","full_name":"Modbus::TCPClient","name":"TCPClient"}],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"unit_address-instance-method","html_id":"unit_address-instance-method","name":"unit_address","doc":null,"summary":null,"abstract":true,"args":[],"args_string":"","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp.cr#L8","def":{"name":"unit_address","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":""}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/TCPClient","path":"Modbus/TCPClient.html","kind":"class","full_name":"Modbus::TCPClient","name":"TCPClient","abstract":false,"superclass":{"html_id":"modbus/Modbus/Client","kind":"class","full_name":"Modbus::Client","name":"Client"},"ancestors":[{"html_id":"modbus/Modbus/TCP","kind":"module","full_name":"Modbus::TCP","name":"TCP"},{"html_id":"modbus/Modbus/Client","kind":"class","full_name":"Modbus::Client","name":"Client"},{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/tcp_client.cr","line_number":2,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp_client.cr#L2"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"modbus/Modbus/TCP","kind":"module","full_name":"Modbus::TCP","name":"TCP"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(io,unit_address:UInt8=1)-class-method","html_id":"new(io,unit_address:UInt8=1)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"unit_address","doc":null,"default_value":"1","external_name":"unit_address","restriction":"UInt8"}],"args_string":"(io, unit_address : UInt8 = <span class=\"n\">1</span>)","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp_client.cr#L7","def":{"name":"new","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":""},{"name":"unit_address","doc":null,"default_value":"1","external_name":"unit_address","restriction":"UInt8"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(io, unit_address)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"unit_address:UInt8-instance-method","html_id":"unit_address:UInt8-instance-method","name":"unit_address","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : UInt8","source_link":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp_client.cr#L5","def":{"name":"unit_address","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@unit_address"}}],"macros":[],"types":[]},{"html_id":"modbus/Modbus/TCPException","path":"Modbus/TCPException.html","kind":"class","full_name":"Modbus::TCPException","name":"TCPException","abstract":false,"superclass":{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},"ancestors":[{"html_id":"modbus/Exception","kind":"class","full_name":"Exception","name":"Exception"},{"html_id":"modbus/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"modbus/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/modbus/tcp.cr","line_number":2,"url":"https://github.com/scttnlsn/modbus.cr/blob/9cd36e453c282ac83582f21525d8af60527c55b2/src/modbus/tcp.cr#L2"}],"repository_name":"modbus","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"modbus/Modbus","kind":"module","full_name":"Modbus","name":"Modbus"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]}]}]}})